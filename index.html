<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>P2P Chat & Video Call</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header class="header">
            <h1>P2P Chat <span id="connectionStatus" class="status-dot" aria-label="Connection status"></span></h1>
            <button class="theme-toggle" id="themeToggle" aria-label="Switch to dark theme">
                <i class="fas fa-moon"></i>
            </button>
        </header>
        
        <section class="peer-info">
            <p id="peerIdDisplay">Your Peer ID: Loading...</p>
            <div class="peer-actions">
                <div class="action-group">
                    <button id="connectButton" class="connect-button" title="Connect to Peer" aria-label="Connect to peer">
                        <i class="fas fa-plug"></i> Connect
                    </button>
                    <button id="shareIdButton" title="Share Peer ID" aria-label="Share peer ID">
                        <i class="fas fa-share-alt"></i> Share
                    </button>
                </div>
                <div class="action-group">
                    <button id="disconnectButton" title="Disconnect" aria-label="Disconnect from peer">
                        <i class="fas fa-plug"></i> Disconnect
                    </button>
                    <button id="clearChatButton" title="Clear Chat" aria-label="Clear chat">
                        <i class="fas fa-trash"></i> Clear
                    </button>
                </div>
            </div>
        </section>

        <div id="qrModal" class="modal" aria-live="polite">
            <div class="modal-content">
                <span class="close" aria-label="Close QR modal">×</span>
                <h3>Share Your Peer ID</h3>
                <div id="qrCode"></div>
                <p>Scan this code to connect</p>
                <input type="text" id="peerIdCopy" readonly aria-label="Your peer ID">
                <button id="copyIdButton" aria-label="Copy peer ID">Copy ID</button>
            </div>
        </div>

        <div id="connectModal" class="modal" aria-live="polite">
            <div class="modal-content">
                <span class="close" aria-label="Close connect modal">×</span>
                <h3>Connect to Peer</h3>
                <video id="qrScanner" width="300" height="300" aria-hidden="true"></video>
                <p>Or enter peer ID manually:</p>
                <input type="text" id="manualPeerIdInput" placeholder="Enter Peer ID" aria-label="Manual peer ID input">
                <button id="connectManualButton" aria-label="Connect manually">Connect</button>
            </div>
        </div>

        <div id="setupModal" class="modal" aria-live="polite">
            <div class="modal-content">
                <h3>Setup Your Profile</h3>
                <form id="setupForm">
                    <label for="usernameInput">Your Name:</label>
                    <input type="text" id="usernameInput" required aria-label="Your username">
                    <label for="peerIdInput">Your Peer ID:</label>
                    <input type="text" id="peerIdInput" required aria-label="Your peer ID">
                    <button type="submit" aria-label="Start chatting">Start Chatting</button>
                </form>
            </div>
        </div>

        <main class="main-content">
            <aside class="sidebar">
                <div class="contact-list">
                    <h3>Contacts <button id="addContactButton" title="Add Contact" aria-label="Add new contact"><i class="fas fa-plus"></i></button></h3>
                    <ul id="contactsList" role="list"></ul>
                </div>
               
            </aside>

            <section class="chat-container">
                <div id="chatBox" role="log" aria-live="polite"></div>
                <div class="message-input-container">
                    <div class="message-actions">
                        <div class="action-group">
                            <button id="attachFileButton" title="Attach File" aria-label="Attach file">
                                <i class="fas fa-paperclip"></i>
                            </button>
                            <button id="sendVoiceButton" title="Record Voice Message" aria-label="Record voice message">
                                <i class="fas fa-microphone"></i>
                            </button>
                            <button id="emojiButton" title="Add Emoji" aria-label="Add emoji">
                                <i class="far fa-smile"></i>
                            </button>
                        </div>
                    </div>
                    <input type="text" id="messageInput" placeholder="Type your message..." aria-label="Message input">
                    <button id="sendButton" title="Send Message" aria-label="Send message">
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </div>
                <input type="file" id="fileInput" style="display: none;" aria-hidden="true">
                <div id="fileProgressContainer" style="display: none;">
                    <div class="file-info-container">
                        <span id="fileName" aria-label="File name"></span>
                        <span id="fileProgress" aria-label="File upload progress">0%</span>
                    </div>
                    <progress id="fileProgressBar" value="0" max="100" aria-label="File upload progress bar"></progress>
                    <button id="cancelFileButton" aria-label="Cancel file upload">Cancel</button>
                </div>
            </section>

            <section class="video-container">
                <div class="video-wrapper">
                    <video id="localVideo" autoplay muted aria-label="Local video"></video>
                    <div class="video-controls">
                        <div class="volume-control">
                            <span>Volume:</span>
                            <input type="range" id="localVolume" min="0" max="1" step="0.1" value="1" aria-label="Local video volume">
                        </div>
                    </div>
                </div>
                <div class="video-wrapper">
                    <video id="remoteVideo" autoplay aria-label="Remote video"></video>
                    <div class="video-controls">
                        <div class="volume-control">
                            <span>Volume:</span>
                            <input type="range" id="remoteVolume" min="0" max="1" step="0.1" value="1" aria-label="Remote video volume">
                        </div>
                    </div>
                </div>

            </section>
            <div class="call-controls">
                <h3>Call Controls</h3>
                <div class="action-group">
                    <button id="callButton" title="Start Video Call" aria-label="Start video call">
                        <i class="fas fa-video"></i> Start Call
                    </button>
                    <button id="endCallButton" title="End Call" aria-label="End video call">
                        <i class="fas fa-phone-slash"></i> End Call
                    </button>
                </div>
                <div class="action-group">
                    <button id="screenShareButton" title="Share Screen" aria-label="Share screen">
                        <i class="fas fa-desktop"></i> Share Screen
                    </button>
                    <button id="muteButton" title="Mute Microphone" aria-label="Mute microphone">
                        <i class="fas fa-microphone"></i> Mute
                    </button>
                    <button id="pauseVideoButton" title="Pause Video" aria-label="Pause video">
                        <i class="fas fa-video-slash"></i> Pause Video
                    </button>
                    <button id="clearChatButton" title="Clear Chat" aria-label="Clear chat">
                        <i class="fas fa-trash"></i> Clear Chat
                    </button>
                </div>
            </div>
        </main>

        <div class="notification-center" id="notificationCenter" role="alert"></div>
    </div>

    <script src="https://unpkg.com/peerjs@1.4.7/dist/peerjs.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/qrcodejs/qrcode.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jsqr@1.4.0/dist/jsQR.min.js"></script>
    <script src="app.js"></script>
</body>
</html>